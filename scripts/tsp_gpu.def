Bootstrap: docker
From: nvidia/cuda:12.4.0-devel-ubuntu22.04

%post
    # Basic tools
    apt-get update && apt-get install -y \
        python3-pip python3-dev git wget build-essential && \
        rm -rf /var/lib/apt/lists/*

    # Upgrade pip
    python3 -m pip install --upgrade pip

    # Install Python packages
    pip install cupy==13.2.0 mpi4py h5py

    # For Debian/Ubuntu
    apt-get update && apt-get install -y libopenmpi-dev openmpi-bin

%environment
    export PATH=/usr/bin:$PATH
    export PYTHONNOUSERSITE=1

%runscript
    exec python3 "$@"


